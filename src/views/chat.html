<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link
            href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300&display=swap"
            rel="stylesheet"
        />
        <title>GREAT-GREAT!!</title>
        <link rel="stylesheet" href="/stylesheets/chat.css" />
    </head>
    <body>
        <div class="container">
            <div class="logo">
                <span>효과는 굉장했다 !</span>
            </div>
            <div class="windows">
                <div class="commendWindow">
                    <section class="userInfo" id="userInfo">
                        <span>홍길동 / Lv.001</span>
                    </section>
                    <section class="commendLine"><span>야압! 기합을 실은 당신의 정권지르기가 고슴도치에게격중되었다 ! <span style="color: green">=> 6</span>
                    고슴도치가 필사적으로 가시를 곤두세운다 ! <span style="color: red">이잉.. 아프네.. -8</span>

                당신은 고슴도치를 철검으로 강력하게 공격했다. <span style="color: green">=> 10</span>
            아앗.. 고슴도치의 가시가 당신의 온 팔에 박혔다 ! <span style="color: red">아야야~ -9</span>

            당신은 고슴도치를 철검으로 강력하게 공격했다. <span style="color: green">=> 9</span>
            고슴도치가 필사적으로 가시를 곤두세운다 ! <span style="color: red">이잉.. 아프네.. -8</span>

            당신은 고슴도치를 철검으로 있는 힘을 다해 후려쳤다 ! <span style="color: green">=> 9</span>
            고슴도치가 사납게 덤볐지만 당신은 날렵하게 피해버렸다. 

            휘익~ 가벼운 점프 ↑ -- 이어지는 당신의 우아한 이단 돌려차기 ! <span style="color: green">=> 6</span>
            고슴도치가 필사적으로 가시를 곤두세운다 ! <span style="color: red">이잉.. 아프네.. -8</span>

            당신은 날렵하게 전진하여 철검으로 고슴도치를 찔렀다. <span style="color: green">=> 9</span>
            고슴도치가 중심을 잃고 쓰러진다.
            129 만큼의 기를 흡수합니다.
        </span>
                    </section>
                    <section class="commendInput">
                        <input
                            type="text"
                            placeholder="커맨드를 입력해주세요."
                        /><button type="button">전송</button>
                    </section>
                </div>

                <div class="chatingWindow">
                    <section class="chatingList" id="chatBox">
                        <span style="color: green;">홍길동 : 와 님들 아직도 안자고 게임해요 ?</span>
                        <span>최원선 : 잠이 뭐죠 ?</span>
                        <span>김정현 : 아 원선님 1등 양보좀 해줘요</span>
                    </section>
                    <section class="chatingInput">
                        <input type="text" id="chatSubmit" placeholder="채팅를 입력해주세요." />
                        <button type="button" onclick="chatSubmitdHandler()">전송</button>
                    </section>
                </div>
            </div>
        </div>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
		<script src="https://cdn.socket.io/4.5.3/socket.io.min.js" integrity="sha384-WPFUvHkB1aHA5TDSZi6xtDgkF0wXJcIIxXhC6h8OT8EH3fC5PWro5pWJ1THjcfEi" crossorigin="anonymous"></script>
		<script src="/js/chat.js"></script>
        <script>
            const chatSubmitId = $('#chatSubmit');
            const chatBoxId = $('#chatBox');
            const userInfo = $('#userInfo');

            const socket = io('/');

            $(()=>{
                chatBoxId.empty();
                userInfo.empty();

                const user = localStorage.getItem('user');
                const { username, name, level, maxhp, maxmp, hp, mp, exp } = JSON.parse(user);

                socket.emit('info', { name });

                const status = `
                <div class="infoName">
                    <span>${name} / Lv. ${level}</span><span class="exp">경험치: ${exp}</span>
                </div>
                <div class="infoSub">
                    <div class="infoUser"><span>${username}</span></div>
                    <div class="infoStatus">
                        <span>체력: ${maxhp}/${hp}</span>
                        <span>마나: ${maxmp}/${mp}</span>    
                    </div>
                </div>
                `;
                console.log(status);
                userInfo.append(status);
            });

            const chatNewMessage = ({ script }) => {
                console.log('NEEEEEEEEEEEW', script)
                const newMessage = `<span>${script}</span>`;
                chatBoxId.append(newMessage);
            }

            const chatSubmitdHandler = () => {
                const user = localStorage.getItem('user');
                const { name } = JSON.parse(user);
                const data = {
                    name,
                    message: chatSubmitId.val(),
                }
                socket.emit('submit', data);
                chatSubmitId.val('');
            }            

            


        </script>
	</body>
</html>